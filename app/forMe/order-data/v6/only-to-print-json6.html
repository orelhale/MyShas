<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div id="filds"></div>
    <br />
    <br />
    <div id="id"></div>
</body>

<script>

    let cats = [
        {
            "name": "זרעים",
            "id": "1",
            "list": [
                "ברכות"
            ]
        },
        {
            "name": "מועד",
            "id": "2",
            "list": [
                "שבת",
                "עירובין",
                "פסחים",
                "שקלים",
                "יומא",
                "סוכה",
                "ביצה",
                "ראש השנה",
                "תענית",
                "מגילה",
                "מועד קטן",
                "חגיגה"
            ]
        },
        {
            "name": "נזיקין",
            "id": "4",
            "list": [
                "בבא קמא",
                "בבא מציעא",
                "בבא בתרא",
                "סנהדרין",
                "מכות",
                "שבועות",
                "עבודה זרה",
                "חולין",
                "בכורות",
                "ערכין",
                "תמורה",
                "כריתות",
                "מעילה",
                "תמיד",
                "מנחות",
                "נדה"
            ]
        },
        {
            "name": "נשים",
            "id": "3",
            "list": [
                "יבמות",
                "כתובות",
                "נדרים",
                "נזיר",
                "סוטה",
                "גיטין",
                "קידושין"
            ]
        },
        {
            "name": "קדשים",
            "id": "5",
            "list": [
                "זבחים",
                "מנחות",
                "חולין",
                "בכורות",
                "ערכין",
                "תמורה",
                "קרבן פסחים",
                "מדות",
                "קנים",
                "טמואות",
                "מעילה",
                "תמיד",
                "מנחות",
            ]
        },
        {
            "name": "טהרות",
            "id": "6",
            "list": [
                "כלים",
                "אהלות",
                "נגעים",
                "פרה",
                "טהרות",
                "מקוואות",
                "נדה"
            ]
        },
    ]
    let listMN = ["ברכות", "שבת", "יבמות", "בבא", "קמא", "זבחים", "כלים",
        "פאה", "עירובין", "כתובות", "בבא מציעא", "מנחות", "אוהלות",
        "דמאי", "פסחים", "נדרים", "בבא בתרא", "חולין", "נגעים",
        "כלאים", "שקלים", "נזיר", "סנהדרין", "בכורות", "פרה",
        "שביעית", "יומא", "סוטה", "מכות", "ערכין", "טהרות",
        "תרומות", "סוכה", "גיטין", "שבועות", "תמורה", "מקואות",
        "מעשרות", "ביצה", "קידושין", "עדיות", "כריתות", "נידה",
        "מעשר שני", "ראש השנה", "עבודה זרה", "מעילה", "מכשירין",
        "חלה", "תענית", "תמיד", "זבים",
        "ערלה", "מגילה", "הוריות", "מדות", "טבול יום",
        "בכורים", "מועד קטן", "קנים", "ידים",
        "חגיגה", "עוקצים"
    ]



    let list = [
        { "name": "ברכות", "numPages": 125 },
        { "name": "שבת", "numPages": 312 },
        { "name": "עירובין", "numPages": 207 },
        { "name": "פסחים", "numPages": 240 },
        { "name": "שקלים", "numPages": 42 },
        { "name": "יומא", "numPages": 173 },
        { "name": "סוכה", "numPages": 110 },
        { "name": "ביצה", "numPages": 78 },
        { "name": "ראש השנה", "numPages": 67 },
        { "name": "תענית", "numPages": 59 },
        { "name": "מגילה", "numPages": 61 },
        { "name": "מועד קטן", "numPages": 55 },
        { "name": "חגיגה", "numPages": 51 },
        { "name": "יבמות", "numPages": 242 },
        { "name": "כתובות", "numPages": 222 },
        { "name": "נדרים", "numPages": 180 },
        { "name": "נזיר", "numPages": 130 },
        { "name": "סוטה", "numPages": 96 },
        { "name": "גיטין", "numPages": 178 },
        { "name": "קידושין", "numPages": 162 },
        { "name": "בבא קמא", "numPages": 236 },
        { "name": "בבא מציעא", "numPages": 236 },
        { "name": "בבא בתרא", "numPages": 350 },
        { "name": "סנהדרין", "numPages": 224 },
        { "name": "מכות", "numPages": 48 },
        { "name": "שבועות", "numPages": 96 },
        { "name": "עדיות", "numPages": 40 },
        { "name": "עבודה זרה", "numPages": 150 },
        { "name": "הוריות", "numPages": 25 },
        { "name": "זבחים", "numPages": 238 },
        { "name": "מנחות", "numPages": 110 },
        { "name": "חולין", "numPages": 281 },
        { "name": "בכורות", "numPages": 119 },
        { "name": "ערכין", "numPages": 65 },
        { "name": "תמורה", "numPages": 65 },
        { "name": "כריתות", "numPages": 54 },
        { "name": "מעילה", "numPages": 39 },
        { "name": "קינים", "numPages": 5 },
        { "name": "תמיד", "numPages": 18 },
        { "name": "מדות", "numPages": 8 },
        { "name": "נדה", "numPages": 143 },
    ]

    let listP = ["ב. ", "ב: ", "ג. ", "ג: ", "ד. ", "ד: ", "ה. ", "ה: ", "ו. ", "ו: ", "ז. ", "ז: ", "ח. ", "ח: ", "ט. ", "ט: ", "י. ", "י: ", "יא. ", "יא: ", "יב. ", "יב: ", "יג. ", "יג: ", "יד. ", "יד: ", "טו. ", "טו: ", "טז. ", "טז: ", "יז. ", "יז: ", "יח. ", "יח: ", "יט. ", "יט: ", "כ. ", "כ: ", "כא. ", "כא: ", "כב. ", "כב: ", "כג. ", "כג: ", "כד. ", "כד: ", "כה. ", "כה: ", "כו. ", "כו: ", "כז. ", "כז: ", "כח. ", "כח: ", "כט. ", "כט: ", "ל. ", "ל: ", "לא. ", "לא: ", "לב. ", "לב: ", "לג. ", "לג: ", "לד. ", "לד: ", "לה. ", "לה: ", "לו. ", "לו: ", "לז. ", "לז: ", "לח. ", "לח: ", "לט. ", "לט: ", "מ. ", "מ: ", "מא. ", "מא: ", "מב. ", "מב: ", "מג. ", "מג: ", "מד. ", "מד: ", "מה. ", "מה: ", "מו. ", "מו: ", "מז. ", "מז: ", "מח. ", "מח: ", "מט. ", "מט: ", "נ. ", "נ: ", "נא. ", "נא: ", "נב. ", "נב: ", "נג. ", "נג: ", "נד. ", "נד: ", "נה. ", "נה: ", "נו. ", "נו: ", "נז. ", "נז: ", "נח. ", "נח: ", "נט. ", "נט: ", "ס. ", "ס: ", "סא. ", "סא: ", "סב. ", "סב: ", "סג. ", "סג: ", "סד. ", "סד: ", "סה. ", "סה: ", "סו. ", "סו: ", "סז. ", "סז: ", "סח. ", "סח: ", "סט. ", "סט: ", "ע. ", "ע: ", "עא. ", "עא: ", "עב. ", "עב: ", "עג. ", "עג: ", "עד. ", "עד: ", "עה. ", "עה: ", "עו. ", "עו: ", "עז. ", "עז: ", "עח. ", "עח: ", "עט. ", "עט: ", "פ. ", "פ: ", "פא. ", "פא: ", "פב. ", "פב: ", "פג. ", "פג: ", "פד. ", "פד: ", "פה. ", "פה: ", "פו. ", "פו: ", "פז. ", "פז: ", "פח. ", "פח: ", "פט. ", "פט: ", "צ. ", "צ: ", "צא. ", "צא: ", "צב. ", "צב: ", "צג. ", "צג: ", "צד. ", "צד: ", "צה. ", "צה: ", "צו. ", "צו: ", "צז. ", "צז: ", "צח. ", "צח: ", "צט. ", "צט: ", "ק. ", "ק: ", "קא. ", "קא: ", "קב. ", "קב: ", "קג. ", "קג: ", "קד. ", "קד: ", "קה. ", "קה: ", "קו. ", "קו: ", "קז. ", "קז: ", "קח. ", "קח: ", "קט. ", "קט: ", "קי. ", "קי: ", "קיא. ", "קיא: ", "קיב. ", "קיב: ", "קיג. ", "קיג: ", "קיד. ", "קיד: ", "קטו. ", "קטו: ", "קטז. ", "קטז: ", "קיז. ", "קיז: ", "קיח. ", "קיח: ", "קיט. ", "קיט: ", "קכ. ", "קכ: ", "קכא. ", "קכא: ", "קכב. ", "קכב: ", "קכג. ", "קכג: ", "קכד. ", "קכד: ", "קכה. ", "קכה: ", "קכו. ", "קכו: ", "קכז. ", "קכז: ", "קכח. ", "קכח: ", "קכט. ", "קכט: ", "קל. ", "קל: ", "קלא. ", "קלא: ", "קלב. ", "קלב: ", "קלג. ", "קלג: ", "קלד. ", "קלד: ", "קלה. ", "קלה: ", "קלו. ", "קלו: ", "קלז. ", "קלז: ", "קלח. ", "קלח: ", "קלט. ", "קלט: ", "קמ. ", "קמ: ", "קמא. ", "קמא: ", "קמב. ", "קמב: ", "קמג. ", "קמג: ", "קמד. ", "קמד: ", "קמה. ", "קמה: ", "קמו. ", "קמו: ", "קמז. ", "קמז: ", "קמח. ", "קמח: ", "קמט. ", "קמט: ", "קנ. ", "קנ: ", "קנא. ", "קנא: ", "קנב. ", "קנב: ", "קנג. ", "קנג: ", "קנד. ", "קנד: ", "קנה. ", "קנה: ", "קנו. ", "קנו: ", "קנז. ", "קנז: ", "קנח. ", "קנח: ", "קנט. ", "קנט: ", "קס. ", "קס: ", "קסא. ", "קסא: ", "קסב. ", "קסב: ", "קסג. ", "קסג: ", "קסד. ", "קסד: ", "קסה. ", "קסה: ", "קסו. ", "קסו: ", "קסז. ", "קסז: ", "קסח. ", "קסח: ", "קסט. ", "קסט: ", "קע. ", "קע: ", "קעא. ", "קעא: ", "קעב. ", "קעב: ", "קעג. ", "קעג: ", "קעד. ", "קעד: ", "קעה. ", "קעה: ", "קעו. ", "קעו: ", "קעז. ", "קעז: ", "קעח. ", "קעח: ", "קעט. ", "קעט: ", "קפ. ", "קפ: ", "קפא. ", "קפא: ", "קפב. ", "קפב: ", "קפג. ", "קפג: ", "קפד. ", "קפד: ", "קפה. ", "קפה: ", "קפו. ", "קפו: ", "קפז. ", "קפז: ", "קפח. ", "קפח: ", "קפט. ", "קפט: ", "קצ. ", "קצ: ", "קצא. ", "קצא: ", "קצב. ", "קצב: ", "קצג. ", "קצג: ", "קצד. ", "קצד: ", "קצה. ", "קצה: ", "קצו. ", "קצו: ", "קצז. ", "קצז: ", "קצח. ", "קצח: ", "קצט. ", "קצט: "]

    let div = document.querySelector("#id")
    let filds = document.querySelector("#filds")

    function print(text) {
        div.innerHTML += `<div>${text}</div>`
    }

    function addFildToCat() {
        for (const cat of cats) {
            cat.numPages = 0;
            cat.finishedPages = 0;
            cat.completed = 0;
        }
    }

    function addFildToGmara() {
        for (const gmara of list) {
            gmara.completed = 0
            gmara.finishedPages = 0
        }
    }

    function addFilds() {

        for (let i = 0; i < list.length; i++) {

            let obj = list[i]
            obj.id = i + 1
            // מביא את ההסדר של אותה מסכת, ואם לא נמצא סדר אז הוא מדלג למסכת הבאה
            let catName = ""
            for (const key of cats) {
                // console.log("key ==== ", key);
                if (key.list.includes(list[i].name)) {
                    console.log("item = ", list[i].name, " cat = ", key.name);
                    catName = key
                }
            }
            if (!catName) {
                continue
            }
            // obj.cat = catName.name
            obj.catId = catName.id
            // מוסיף את רשימת הדפים של המסכת (לפי מספר הדפים במסכת ככה יהיה רשימת הדפים)
            obj.pageTrack = {}
            // obj.pageObj = {}
            for (let p = 0; p < obj.numPages; p++) {
                let page = listP[p]
                let index = page.indexOf(" ")
                if (index != -1) {
                    page = page.substring(0, index)
                }
                obj.pageTrack[page] = false
            }
        }

    }

    function app(params) {

        print("[")
        for (let i = 0; i < cats.length; i++) {
            if (i < cats.length - 1) {
                print(JSON.stringify(cats[i]) + ",")

            } else {

                print(JSON.stringify(cats[i]))
            }
        }
        print("]")


        console.log("cats == ", cats);
    }

    function printFildsPage() {
        let listFilds = Object.keys(list[0])
        console.log("listFilds ==== ", listFilds);
        filds.innerHTML += `<h4>Page filds</h4>`
        for (let i = 0; i < listFilds.length; i++) {
            filds.innerHTML += `<div>${listFilds[i]}</div>`

            // filds.innerHTML += `<div>${listFilds[i]}</div>`
        }

    }
    function printFildsCat() {
        let listFilds = Object.keys(cats[0])
        console.log("listFilds ==== ", listFilds);
        filds.innerHTML += `<h4>Cats filds</h4>`
        for (let i = 0; i < listFilds.length; i++) {
            filds.innerHTML += `<div>${listFilds[i]}</div>`

            // filds.innerHTML += `<div>${listFilds[i]}</div>`
        }

    }


    function addItemToCat() {
        for (const cat of cats) {
            cat.numPages = 0
            cat.list = []
            for (const item of list) {
                if (cat.id == item.catId) {
                    cat.list.push(item)
                }
            }
            // console.log("cat.list === ",cat.list);
            cat.list.forEach((a) => { cat.numPages += a.numPages })
            console.log("cat.numPages === ", cat.numPages);
        }
    }


    addFildToCat()
    addFildToGmara()
    addFilds()
    addItemToCat()
    printFildsCat()
    printFildsPage()
    app()


</script>

</html>